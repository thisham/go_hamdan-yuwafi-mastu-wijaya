import { Timestamp } from "mongodb";
import { client, connector } from "./connector";
import { Transaction, User } from "./types";

async function main() {
  const db = await connector();

  // queries

  // clause 1:1a
  db.operators.insertMany([
    {
      _id: 1,
      name: "operator satu",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 2,
      name: "operator dua",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 3,
      name: "operator tiga",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 4,
      name: "operator empat",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 5,
      name: "operator lima",
      created_at: new Date(),
      updated_at: new Date(),
    },
  ]);

  // clause 1:1b
  db.product_types.insertMany([
    { _id: 1, name: "laptop", created_at: new Date(), updated_at: new Date() },
    {
      _id: 2,
      name: "handheld",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 3,
      name: "perangkat tambahan",
      created_at: new Date(),
      updated_at: new Date(),
    },
  ]);

  // clause 1:1c - 1:1e
  db.products.insertMany([
    {
      _id: 1,
      _product_type_id: 1,
      _operator_id: 3,
      code: "LAP389",
      name: "SUSA-X402",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 2,
      _product_type_id: 1,
      _operator_id: 3,
      code: "LAP380",
      name: "ASHER-ASD1",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 3,
      _product_type_id: 2,
      _operator_id: 1,
      code: "HAN131",
      name: "OPO-3193",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 4,
      _product_type_id: 2,
      _operator_id: 1,
      code: "HAN492",
      name: "SIOMAY-X3",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 5,
      _product_type_id: 2,
      _operator_id: 1,
      code: "HAN213",
      name: "VIVA-V32",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 6,
      _product_type_id: 3,
      _operator_id: 4,
      code: "DEV302",
      name: "Headset 30an",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 7,
      _product_type_id: 3,
      _operator_id: 4,
      code: "DEV381",
      name: "Kabel data",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 8,
      _product_type_id: 3,
      _operator_id: 4,
      code: "DEV323",
      name: "SDCard 32GB",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
  ]);

  // clause 1:1f
  db.product_descriptions.insertMany([
    {
      _id: 1,
      description: "Laptop apik SUSA berkualiti",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 2,
      description: "Laptop apik ASHER berkualiti",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 3,
      description: "HP apik OPO kamera mantap",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 4,
      description: "HP apik SIOMAY nikmat lezat",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 5,
      description: "HP apik VIVA tergahar",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 6,
      description: "Devkit paling ngebass",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 7,
      description: "Kabel data kuat awet",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 8,
      description: "Kapasitas lega buat simpen banyak di kandang",
      created_at: new Date(),
      updated_at: new Date(),
    },
  ]);

  // clause 1:1g
  db.payment_methods.insertMany([
    {
      _id: 1,
      name: "tukar beras",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 2,
      name: "linkwae",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 3,
      name: "bayar pake tanah",
      status: true,
      created_at: new Date(),
      updated_at: new Date(),
    },
  ]);

  // clause 1:1h
  db.users.insertMany([
    {
      _id: 1,
      name: "Zaid Muammar Toha",
      status: true,
      birthdate: new Date("2002-02-02"),
      gender: "M",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 2,
      name: "Rara Yunita",
      status: true,
      birthdate: new Date("2000-02-03"),
      gender: "F",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 3,
      name: "Danil Surya Hendrawan",
      status: true,
      birthdate: new Date("1989-04-02"),
      gender: "M",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 4,
      name: "Siti Maryam",
      status: true,
      birthdate: new Date("1995-02-05"),
      gender: "F",
      created_at: new Date(),
      updated_at: new Date(),
    },
    {
      _id: 5,
      name: "Damar Danendra",
      status: true,
      birthdate: new Date("1999-12-25"),
      gender: "M",
      created_at: new Date(),
      updated_at: new Date(),
    },
  ]);

  // clause 1:1i
  db.transactions.insertMany([
    {
      _id: 1,
      _user_id: 1,
      _payment_method_id: 1,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 2,
      _user_id: 1,
      _payment_method_id: 2,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 3,
      _user_id: 1,
      _payment_method_id: 3,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 4,
      _user_id: 2,
      _payment_method_id: 1,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 5,
      _user_id: 2,
      _payment_method_id: 2,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 6,
      _user_id: 2,
      _payment_method_id: 3,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 7,
      _user_id: 3,
      _payment_method_id: 1,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 8,
      _user_id: 3,
      _payment_method_id: 2,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 9,
      _user_id: 3,
      _payment_method_id: 3,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 10,
      _user_id: 4,
      _payment_method_id: 1,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 11,
      _user_id: 4,
      _payment_method_id: 2,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 12,
      _user_id: 4,
      _payment_method_id: 3,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 13,
      _user_id: 5,
      _payment_method_id: 1,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 14,
      _user_id: 5,
      _payment_method_id: 2,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _id: 15,
      _user_id: 5,
      _payment_method_id: 3,
      status: "paid",
      total_quantity: 3,
      total_price: 300000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
  ]);

  // clause 1:1j
  db.transaction_details.insertMany([
    {
      _transaction_id: 1,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 1,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 1,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 2,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 2,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 2,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 3,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 3,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 3,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 4,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 4,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 4,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 5,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 5,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 5,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 6,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 6,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 6,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 7,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 7,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 7,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 8,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 8,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 8,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 9,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 9,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 9,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 10,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 10,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 10,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 11,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 11,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 11,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 12,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 12,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 12,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 13,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 13,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 13,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 14,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 14,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 14,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 15,
      _product_id: 1,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 15,
      _product_id: 2,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
    {
      _transaction_id: 15,
      _product_id: 3,
      status: "paid",
      quantity: 1,
      price: 100000,
      created_at: new Date("2022-03-20 00:38:53"),
      updated_at: new Date("2022-03-20 00:38:53"),
    },
  ]);

  // clause 1:2a
  db.users.aggregate([{ $match: { gender: "M" } }]);

  // clause 1:2b
  db.products.findOne({ _id: 3 });

  // clause 1:2c
  db.users.aggregate([{ $match: { gender: "F" } }, { $count: "_id" }]);

  // clause 1:2d
  db.users.aggregate([{ $sort: { name: 1 } }]);

  // clause 1:2e
  db.users.find().limit(5);

  // clause 1:3a
  db.products.updateOne({ _id: 1 }, { $set: { name: "product dummy" } });

  // clause 1:3b
  db.transaction_details.updateMany(
    { _product_id: 1 },
    { $set: { quantity: 3 } }
  );

  // clause 1:4a
  db.products.deleteOne({ _id: 1 });

  // clause 1:4b
  db.products.deleteMany({ _product_type_id: 1 });
}

main()
  .then(() => console.log)
  .catch(() => console.error)
  .finally(() => client.close());
